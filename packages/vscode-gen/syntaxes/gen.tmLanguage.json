{
  "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
  "name": "Gen",
  "scopeName": "source.gen",
  "patterns": [
    { "include": "#metadata" },
    { "include": "#comments" },
    { "include": "#annotations" },
    { "include": "#repeats" },
    { "include": "#endings" },
    { "include": "#brackets" },
    { "include": "#rests" },
    { "include": "#notes" }
  ],
  "repository": {
    "metadata": {
      "name": "meta.frontmatter.gen",
      "begin": "^---$",
      "end": "^---$",
      "beginCaptures": {
        "0": { "name": "punctuation.definition.frontmatter.begin.gen" }
      },
      "endCaptures": {
        "0": { "name": "punctuation.definition.frontmatter.end.gen" }
      },
      "patterns": [
        {
          "name": "meta.mapping.gen",
          "match": "^(\\w[\\w-]*)(:)\\s*(.*)$",
          "captures": {
            "1": { "name": "entity.name.tag.yaml" },
            "2": { "name": "punctuation.separator.key-value.yaml" },
            "3": { "name": "string.unquoted.yaml" }
          }
        }
      ]
    },
    "comments": {
      "name": "comment.line.double-slash.gen",
      "match": "//.*$"
    },
    "annotations": {
      "patterns": [
        {
          "name": "meta.annotation.mod-point.gen",
          "match": "@(Eb|Bb|F|C|G):(\\^+|_+)",
          "captures": {
            "1": { "name": "entity.name.function.gen" },
            "2": { "name": "keyword.operator.octave.gen" }
          }
        },
        {
          "name": "meta.annotation.key-change.gen",
          "match": "@key:([A-G][#b]?m?|#{1,4}|b{1,4})",
          "captures": {
            "0": { "name": "keyword.control.key-change.gen" },
            "1": { "name": "constant.language.key.gen" }
          }
        },
        {
          "name": "meta.annotation.chord.gen",
          "match": "@ch:([A-G][#b]?[^\\s]*)",
          "captures": {
            "0": { "name": "entity.name.type.chord.gen" },
            "1": { "name": "string.other.chord-symbol.gen" }
          }
        },
        {
          "name": "meta.annotation.measure-octave.gen",
          "match": "@:(\\^+|_+)",
          "captures": {
            "0": { "name": "keyword.operator.measure-octave.gen" }
          }
        }
      ]
    },
    "repeats": {
      "patterns": [
        {
          "name": "keyword.control.repeat-start.gen",
          "match": "\\|\\|:"
        },
        {
          "name": "keyword.control.repeat-end.gen",
          "match": ":\\|\\|"
        }
      ]
    },
    "endings": {
      "patterns": [
        {
          "name": "keyword.control.ending.gen",
          "match": "\\b([12])\\.",
          "captures": {
            "1": { "name": "constant.numeric.ending.gen" }
          }
        }
      ]
    },
    "brackets": {
      "name": "meta.group.gen",
      "begin": "(\\^*|_*)(\\[)",
      "end": "(\\])([0-9]*)?([/po\\*]*)?",
      "beginCaptures": {
        "1": { "name": "keyword.operator.octave.gen" },
        "2": { "name": "punctuation.definition.group.begin.gen" }
      },
      "endCaptures": {
        "1": { "name": "punctuation.definition.group.end.gen" },
        "2": { "name": "constant.numeric.tuplet.gen" },
        "3": { "name": "keyword.operator.rhythm.gen" }
      },
      "patterns": [
        { "include": "#rests" },
        { "include": "#notes" }
      ]
    },
    "rests": {
      "name": "constant.language.rest.gen",
      "match": "\\$([/po\\*]*)",
      "captures": {
        "0": { "name": "constant.language.rest.gen" },
        "1": { "name": "keyword.operator.rhythm.gen" }
      }
    },
    "notes": {
      "name": "meta.note.gen",
      "match": "(\\^+|_+)?([A-G])([#b])?(o|p|\\/+)?(\\*)?",
      "captures": {
        "1": { "name": "keyword.operator.octave.gen" },
        "2": { "name": "variable.other.note.gen" },
        "3": { "name": "constant.character.accidental.gen" },
        "4": { "name": "keyword.operator.rhythm.gen" },
        "5": { "name": "keyword.operator.dotted.gen" }
      }
    }
  }
}
