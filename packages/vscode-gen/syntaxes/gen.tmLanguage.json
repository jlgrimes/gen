{
  "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
  "name": "Gen",
  "scopeName": "source.gen",
  "patterns": [
    { "include": "#metadata" },
    { "include": "#chords" },
    { "include": "#annotations" },
    { "include": "#repeats" },
    { "include": "#endings" },
    { "include": "#brackets" },
    { "include": "#rests" },
    { "include": "#notes" }
  ],
  "repository": {
    "metadata": {
      "name": "meta.frontmatter.gen",
      "begin": "^---$",
      "end": "^---$",
      "beginCaptures": {
        "0": { "name": "punctuation.definition.frontmatter.begin.gen" }
      },
      "endCaptures": {
        "0": { "name": "punctuation.definition.frontmatter.end.gen" }
      },
      "patterns": [
        {
          "name": "meta.mapping.gen",
          "match": "^(\\w[\\w-]*)(:)\\s*(.*)$",
          "captures": {
            "1": { "name": "entity.name.tag.yaml" },
            "2": { "name": "punctuation.separator.key-value.yaml" },
            "3": { "name": "string.unquoted.yaml" }
          }
        }
      ]
    },
    "chords": {
      "name": "string.quoted.other.chord.gen",
      "match": "\\{[^\\}]+\\}(/{1,3}|p|o)?(\\*)?(:)?"
    },
    "annotations": {
      "patterns": [
        {
          "name": "entity.name.function.annotation.gen",
          "match": "@(Eb|Bb|F|C|G):(\\^+|_+)"
        },
        {
          "name": "meta.annotation.key.gen",
          "match": "(@key:)([A-G][#b]?m?|#{1,4}|b{1,4})",
          "captures": {
            "1": { "name": "entity.name.function.annotation.gen" },
            "2": { "name": "string.other.key.gen" }
          }
        },
        {
          "name": "entity.name.function.annotation.gen",
          "match": "@:(\\^+|_+)"
        },
        {
          "name": "entity.name.function.annotation.gen",
          "match": "@pickup"
        }
      ]
    },
    "repeats": {
      "patterns": [
        {
          "name": "keyword.control.repeat-start.gen",
          "match": "\\|\\|:"
        },
        {
          "name": "keyword.control.repeat-end.gen",
          "match": ":\\|\\|"
        }
      ]
    },
    "endings": {
      "patterns": [
        {
          "name": "keyword.control.ending.gen",
          "match": "\\b[12]\\."
        }
      ]
    },
    "brackets": {
      "name": "meta.group.gen",
      "begin": "(\\^+|_+)?(\\[)",
      "end": "(\\])([0-9]+)?(/{1,3}|p|o)?(\\*)?",
      "beginCaptures": {
        "1": { "name": "keyword.control.octave.gen" },
        "2": { "name": "punctuation.section.brackets.begin.gen" }
      },
      "endCaptures": {
        "1": { "name": "punctuation.section.brackets.end.gen" },
        "2": { "name": "constant.numeric.tuplet.gen" },
        "3": { "name": "constant.numeric.rhythm.gen" },
        "4": { "name": "constant.numeric.rhythm.gen" }
      },
      "patterns": [
        { "include": "#rests" },
        { "include": "#notes" }
      ]
    },
    "rests": {
      "name": "meta.rest.gen",
      "match": "(\\$)(/{1,3}|p|o)?(\\*)?",
      "captures": {
        "1": { "name": "constant.numeric.rest.gen" },
        "2": { "name": "constant.numeric.rhythm.gen" },
        "3": { "name": "constant.numeric.rhythm.gen" }
      }
    },
    "notes": {
      "name": "meta.note.gen",
      "match": "(\\^+|_+)?([A-G][#b%]?)(/{1,3}|p|o)?(\\*)?",
      "captures": {
        "1": { "name": "keyword.control.octave.gen" },
        "2": { "name": "variable.other.note.gen" },
        "3": { "name": "constant.numeric.rhythm.gen" },
        "4": { "name": "constant.numeric.rhythm.gen" }
      }
    }
  }
}
